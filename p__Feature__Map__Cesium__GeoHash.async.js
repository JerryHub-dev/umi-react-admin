"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[899],{95494:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var o=n(54306),s=n.n(o);function a(e,t,n){for(var o=[16,8,4,2,1],s=!0,a=-90,i=90,r=-180,c=180,l=0,u=0,d="";d.length<n;){if(s){var g=(r+c)/2;t>g?(u|=o[l],r=g):c=g}else{var m=(a+i)/2;e>m?(u|=o[l],a=m):i=m}s=!s,l<4?l++:(d+="0123456789bcdefghjkmnpqrstuvwxyz"[u],l=0,u=0)}return d}var i=n(80583),r=n(57688),c=n(4872),l=n(20136),u=n(74970),d=n(3964),g=n(49283),m=n(39301),h=n(80078),f=n(10655),v=n(3035),Z=n(72348),x=n(85831),p=n(43290),D=n(63452),C=(n(88949),n(93236)),j=n(62086),w=function(){var e=(0,C.useState)(null),t=s()(e,2),n=t[0],o=t[1],w=r.ZP.useMessage(),k=s()(w,2),N=k[0],b=k[1];g.Z.defaultAccessToken={NODE_ENV:"production",PUBLIC_PATH:"/umi-react-admin/"}.CESIUM_ION_TOKEN,(0,C.useEffect)((function(){var e=new m.Z("cesiumContainer",{animation:!1,infoBox:!1,sceneModePicker:!0,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,shouldAnimate:!0,skyAtmosphere:!1,skyBox:!1,vrButton:!1});e.cesiumWidget.creditContainer.style.display="none";var t={destination:h.Z.fromDegrees(116.3974,39.9093,15e6)};return e.camera.flyTo(t),e.screenSpaceEventHandler.setInputAction((function(t){var n=e.camera.pickEllipsoid(t.position,e.scene.globe.ellipsoid);if(n){var o=f.Z.fromCartesian(n),s=v.Z.toDegrees(o.longitude).toFixed(2),a=v.Z.toDegrees(o.latitude).toFixed(2);N.info("Longitude: ".concat(s,", Latitude: ").concat(a))}}),Z.Z.LEFT_CLICK),e.camera.moveEnd.addEventListener((function(){var t=e.camera.positionCartographic.height;console.log("相机高度变化: ",t)})),o(e),function(){e.destroy()}}),[]);var E=(0,C.useState)(""),M=s()(E,2),A=M[0],y=M[1],P=(0,C.useState)(5),S=s()(P,2),B=S[0],I=S[1],L=(0,C.useState)(""),T=s()(L,2),H=T[0],V=T[1],_=(0,C.useState)(""),F=s()(_,2),G=F[0],K=F[1];var O=(0,C.useState)([]),R=s()(O,2),z=R[0],q=R[1],U=function(){var e,t=(e=n.camera.computeViewRectangle())?{west:v.Z.toDegrees(e.west),south:v.Z.toDegrees(e.south),east:v.Z.toDegrees(e.east),north:v.Z.toDegrees(e.north)}:null;if(t){console.log("Map view rectangle:",t);var o=function(e,t){for(var o=e.west,s=e.south,i=(e.east-o)/3,r=(e.north-s)/2,c=[],l=0;l<3;l++)for(var u=0;u<2;u++){var d=o+l*i,g=d+i,m=s+u*r,h=m+r,f=a((m+h)/2,(d+g)/2,t);c.push({geohash:f,bounds:{subWest:d,subSouth:m,subEast:g,subNorth:h}}),n.entities.add({rectangle:{coordinates:x.Z.fromDegrees(d,m,g,h),material:p.Z.RED.withAlpha(.3),outline:!0,outlineColor:p.Z.BLACK}})}return c}(t,5);console.log("Geohashes for sub-areas:",o),q(o)}};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.Z,{className:"mb-2",message:"空间点索引算法-GeoHash",type:"success"}),(0,j.jsxs)(i.Z,{children:[b,null===n&&(0,j.jsx)(l.Z,{spinning:!0}),(0,j.jsx)("div",{id:"cesiumContainer"}),(0,j.jsx)(u.ZP,{className:"mt-2",onClick:function(){n.entities.removeAll()},children:"清除所有"}),(0,j.jsxs)("div",{className:"mt-2",children:[(0,j.jsx)(u.ZP,{onClick:function(){return U()},children:"视图范围内 geohash"}),z.map((function(e,t){return(0,j.jsx)("span",{className:"ml-2 text-red-600",children:e.geohash},t)}))]}),(0,j.jsxs)("div",{className:"mt-2",children:[(0,j.jsx)(u.ZP,{onClick:function(){return function(){if(null!==n){var e=n.camera.computeViewRectangle(),t=x.Z.southwest(e),o=x.Z.southeast(e),s=x.Z.northeast(e),a=x.Z.northwest(e);K("\n      西北角/左上角: ".concat(v.Z.toDegrees(a.longitude),", ").concat(v.Z.toDegrees(a.latitude),"\n      东北角/右上角: ").concat(v.Z.toDegrees(s.longitude),", ").concat(v.Z.toDegrees(s.latitude),"\n      东南角/右下角: ").concat(v.Z.toDegrees(o.longitude),", ").concat(v.Z.toDegrees(o.latitude),"\n      西南角/左下角: ").concat(v.Z.toDegrees(t.longitude),", ").concat(v.Z.toDegrees(t.latitude),"\n    "))}}()},children:"获取视图范围"}),(0,j.jsx)("div",{className:"ml-4 text-red-600 text-success",children:G})]}),(0,j.jsxs)("div",{className:"mt-2",children:[(0,j.jsx)(d.Z,{addonBefore:"精度",className:"mr-2 w-[120px]",min:1,max:10,value:B,defaultValue:B,onChange:function(e){I(e)}}),(0,j.jsx)(u.ZP,{onClick:function(){return function(){if(null!==n){var e=n.camera.position,t=f.Z.fromCartesian(e);console.log(t);var o=v.Z.toDegrees(t.longitude),s=v.Z.toDegrees(t.latitude);console.log(o,s);var i=a(s,o,B);N.success("生成的GeoHash: ".concat(i)),V(i),setTimeout((function(){n.entities.removeAll();var e=function(e){if(0===e.length)return null;for(var t=[16,8,4,2,1],n=!0,o=-90,s=90,a=-180,i=180,r=0,c=0,l=0,u=0;u<e.length;u++){l="0123456789bcdefghjkmnpqrstuvwxyz".indexOf(e[u]);for(var d=0;d<5;d++){var g=t[d];n?(c=(a+i)/2,l&g?a=c:i=c):(r=(o+s)/2,l&g?o=r:s=r),n=!n}}return{latitude:r,longitude:c,latitudeMin:o,latitudeMax:s,longitudeMin:a,longitudeMax:i}}(i);console.log(e);var t=x.Z.fromDegrees(e.longitudeMin,e.latitudeMin,e.longitudeMax,e.latitudeMax),o=n.entities.add({rectangle:{coordinates:t,fill:!0,material:p.Z.RED.withAlpha(.5),outline:!0,outlineColor:p.Z.BLACK}});n.zoomTo(o,new D.Z(0,-.5,0))}),100)}}()},children:"生成 GeoHash"}),(0,j.jsx)("span",{className:"ml-4 text-red-600 text-success",children:H})]}),(0,j.jsxs)("div",{className:"mt-2",children:[(0,j.jsx)(u.ZP,{onClick:function(){return function(){if(null!==n){var e=n.camera.position,t=f.Z.fromCartesian(e),o=v.Z.toDegrees(t.longitude),s=v.Z.toDegrees(t.latitude);N.success("中心点坐标: ".concat(o,", ").concat(s)),y("".concat(o,", ").concat(s))}}()},children:"获取中心点坐标"}),(0,j.jsx)("span",{className:"ml-4 text-red-600 text-success",children:A})]})]})]})}}}]);