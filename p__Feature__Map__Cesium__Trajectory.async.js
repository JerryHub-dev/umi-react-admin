"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[645],{35559:function(e,n,t){t.r(n);var o=t(93525),r=t.n(o),i=t(54306),l=t.n(i),a=t(88506),s=t(45207),u=t(34397),c=t(2087),g=t(4872),d=t(74970),A=t(49283),f=t(76087),p=t(80078),y=t(3035),m=t(82106),h=t(10655),w=t(43290),S=t(71604),C=t(72348),E=(t(88949),t(93236)),v=t(62086);n.default=function(){A.Z.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJkZjBmZTAzMS1jMTJkLTQ5OGQtYTkyYS0xODcyMjU3MTQzMmUiLCJpZCI6MTg2MDcxLCJpYXQiOjE3MDM0MDIwMzl9.DQzBf8T_0U92DwjBcYQqdgwhFs-Cx7EacplwoL_ypjY";var e=(0,E.useState)(null),n=l()(e,2),o=n[0],i=n[1],B=window.turf;console.log(B),(0,E.useEffect)((function(){var e=new f.Z("cesiumContainer",{animation:!1,infoBox:!1,sceneModePicker:!0,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,shouldAnimate:!0,skyAtmosphere:!1,skyBox:!1,vrButton:!1});e.cesiumWidget.creditContainer.style.display="none";var n={destination:p.Z.fromDegrees(116.3974,39.9093,15e6)};return e.camera.flyTo(n),i(e),setTimeout((function(){k(e)}),100),function(){e.destroy()}}),[]);var k=function(e){var n=s.HR[0];e.entities.add({id:n.id,position:p.Z.fromDegrees(n.longitude,n.latitude),billboard:{image:t(15338),scale:.3}}).properties={text:n.label}},O=(0,E.useState)(!1),D=l()(O,2),L=D[0],Q=D[1],R=E.useRef(!1),x=E.useRef([]),F=E.useRef([]),U=E.useRef(null);function b(e){if(console.log("Input polygonArrays:",JSON.stringify(e,null,2)),!Array.isArray(e)||0===e.length)throw new Error("Input must be a non-empty array of polygon coordinates.");function n(e,n){return e.longitude===n.longitude&&e.latitude===n.latitude}var t=e.map((function(e,t){if(!Array.isArray(e)||e.length<3)return console.warn("Polygon at index ".concat(t," is invalid (less than 3 points). Skipping.")),null;var o=e.filter((function(e,t,o){return function(e){return e&&"number"==typeof e.longitude&&"number"==typeof e.latitude&&!isNaN(e.longitude)&&!isNaN(e.latitude)}(e)&&(0===t||!n(e,o[t-1]))}));return o.length<3?(console.warn("Polygon at index ".concat(t," has less than 3 valid unique points. Skipping.")),null):(n(o[0],o[o.length-1])||o.push(o[0]),console.log("Processed polygon ".concat(t,":"),JSON.stringify(o,null,2)),o)})).filter(Boolean);if(console.log("Valid polygons:",JSON.stringify(t,null,2)),0===t.length)throw new Error("No valid polygons to merge.");var o=t.map((function(e,n){try{var t=e.map((function(e){return[e.longitude,e.latitude]}));return console.log("Creating turf polygon ".concat(n," with coordinates:"),JSON.stringify(t)),B.polygon([t])}catch(e){return console.error("Error creating turf polygon ".concat(n,":"),e),null}})).filter(Boolean);if(console.log("Created turf polygons:",o.length),0===o.length)throw new Error("Failed to create valid turf polygons.");if(1===o.length)return console.log("Only one valid polygon, no merging needed."),o[0].geometry.coordinates[0].map((function(e){return{longitude:e[0],latitude:e[1]}}));try{console.log("Combining polygons using turf.combine");var r=B.featureCollection(o),i=B.combine(r);if(console.log("Combined result:",JSON.stringify(i)),!i||!i.features||0===i.features.length)throw new Error("Combination resulted in no features");var l=i.features[0];if(!l||!l.geometry||!l.geometry.coordinates)throw new Error("Invalid merged polygon structure");return("MultiPolygon"===l.geometry.type?l.geometry.coordinates[0][0]:l.geometry.coordinates[0]).map((function(e){return{longitude:e[0],latitude:e[1]}}))}catch(e){throw console.error("Error during polygon combination:",e),new Error("Failed to merge polygons: ".concat(e.message))}}return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.Z,{className:"mb-2",message:"轨迹",type:"success"}),(0,v.jsxs)(c.Z,{children:[(0,v.jsx)("div",{id:"cesiumContainer",className:"static"}),(0,v.jsx)("div",{className:"absolute top-8 left-8",children:L?(0,v.jsx)(d.ZP,{id:"startDrawing",className:"text-cyan-50 hover:text-gray-900",onClick:function(){return function(){Q(!1),R.current=!1,o.cesiumWidget._element.style.cursor="default",U.current.removeInputAction(C.Z.LEFT_CLICK),console.log("positionsArrRef",x.current),console.log("positionsGeoRef",F.current);var e=(0,a.iT)(F.current,1e3);console.log("dataPath",e),e.forEach((function(e){o.entities.add({position:p.Z.fromDegrees(e.longitude,e.latitude),billboard:{image:t(15338),scale:.3}})})),e=[],x.current=[],F.current=[]}()},children:"绘制完成"}):(0,v.jsx)(d.ZP,{id:"startDrawing",className:"text-cyan-50 hover:text-gray-900",onClick:function(){return function(){R.current=!0,Q(!0),o.cesiumWidget._element.style.cursor="crosshair";var e=o.entities.values.find((function(e){return"A"===e.properties.text._value}));console.log(e);var n=o.scene.globe.ellipsoid.cartesianToCartographic(e.position._value),t=y.Z.toDegrees(n.longitude),i=y.Z.toDegrees(n.latitude),l=p.Z.fromDegrees(t,i);x.current=[l],F.current=[{longitude:t,latitude:i}],U.current=new m.Z(o.scene.canvas),U.current.setInputAction((function(e){var n=o.camera.pickEllipsoid(e.position,o.scene.globe.ellipsoid);if(n&&R.current){var t=h.Z.fromCartesian(n),i=y.Z.toDegrees(t.longitude),l=y.Z.toDegrees(t.latitude),a=t.height.toFixed(2);if(console.log(i,l,a),o.entities.add({position:n,ellipse:{semiMinorAxis:30,semiMajorAxis:30,material:new w.Z(1,1,1,.5)}}),x.current.length>=1){var s=x.current[x.current.length-1];o.entities.add({polyline:{positions:new S.Z((function(){return[s,n]}),!1),width:2,material:w.Z.YELLOW}})}x.current=[].concat(r()(x.current),[n]),F.current=[].concat(r()(F.current),[{longitude:i,latitude:l}])}}),C.Z.LEFT_CLICK)}()},children:"开始绘制"})}),(0,v.jsx)(d.ZP,{className:"mt-2",onClick:function(){return function(){var e=JSON.parse(JSON.stringify(u.gJ)),n=JSON.parse(JSON.stringify(u.NU)),t=JSON.parse(JSON.stringify(u.Ei)),r=[];e.forEach((function(e){r.push({longitude:e.longitude,latitude:e.latitude})})),r.push({longitude:e[0].longitude,latitude:e[0].latitude});var i=[];n.forEach((function(e){i.push({longitude:e.longitude,latitude:e.latitude})})),i.push({longitude:n[0].longitude,latitude:n[0].latitude});var l=[];t.forEach((function(e){l.push({longitude:e.longitude,latitude:e.latitude})})),l.push({longitude:l[0].longitude,latitude:l[0].latitude});var a=[r,i,l];console.log("polygonArrays",a);try{var s=b(a);console.log("Merged polygon:",JSON.stringify(s,null,2)),o.entities.add({polygon:{hierarchy:p.Z.fromDegreesArray(s.flatMap((function(e){return[e.longitude,e.latitude]}))),material:w.Z.RED.withAlpha(.5)}})}catch(e){console.error("Error merging polygons:",e)}}()},children:"相交合并渲染"})]})]})}},15338:function(e){e.exports="data:image/png;base64,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"}}]);